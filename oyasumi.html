<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>ãŠã‚„ã™ã¿æ—¥è¨˜ | ã—ãŠã‚“ã®ãƒœãƒ‰ã‚²éƒ¨å±‹</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  body{
    margin:0;
    font-family: system-ui, sans-serif;
    background: url("night-bg.png") no-repeat center center fixed;
    background-size: cover;
    color:#f5f5f5;
    min-height:100vh;
  }

  header{
    padding:18px 24px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background: rgba(255,255,255,.06);
    backdrop-filter: blur(6px);
    border-bottom:1px solid rgba(255,255,255,.15);
    position:sticky;
    top:0;
    z-index:10;
  }

  header a{
    text-decoration:none;
    font-size:14px;
    color:var(--text);
    opacity:.7;
  }
    
  header a:hover{ opacity:1; }

  .container{
    max-width:720px;
    margin:60px auto;
    background: rgba(255,255,255,.06);
    backdrop-filter: blur(8px);
    border-radius:20px;
    padding:40px;
  }

  h1{
    font-size:24px;
    margin-bottom:30px;
    font-weight:600;
  }

  .month-title{
    margin: 28px 0 10px;
    font-size: 16px;
    font-weight: 600;
    opacity: .85;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255,255,255,.12);
  }

  .entry{
    padding:20px 0;
    border-bottom:1px solid rgba(255,255,255,.15);
  }

  .entry:last-child{
    border-bottom:none;
  }

  .date{
    font-size:14px;
    opacity:.6;
    margin-bottom:8px;
  }

  p{
    line-height:1.9;
    margin:0;
  }
  </style>
</head>
<body>
<header>
  <div>ğŸŒ™ ãŠã‚„ã™ã¿æ—¥è¨˜</div>
  <a href="index.html">â† ã—ãŠã‚“ã®ãƒœãƒ‰ã‚²éƒ¨å±‹ã¸æˆ»ã‚‹</a>
</header>

<div class="container">

<h1>ğŸŒ™ ãŠã‚„ã™ã¿æ—¥è¨˜</h1>

<div id="entries"></div>
</div>  

<script>
async function loadDiary(){
  const res = await fetch("diary.json");
  const data = await res.json();

  // 1) æ—¥ä»˜ã‚’æ–°ã—ã„é †ã«ã‚½ãƒ¼ãƒˆ
  data.sort((a, b) => parseDate(b.date) - parseDate(a.date));

  const root = document.getElementById("entries");
  root.innerHTML = "";

  let currentMonthKey = null;

  for (const item of data) {
    const d = parseDate(item.date);
    const monthKey = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;

    // 2) æœˆãŒå¤‰ã‚ã£ãŸã‚‰è¦‹å‡ºã—ã‚’è¿½åŠ 
    if (monthKey !== currentMonthKey) {
      currentMonthKey = monthKey;

      const monthTitle = document.createElement("h2");
      monthTitle.className = "month-title";
      monthTitle.textContent = `${d.getFullYear()}å¹´${d.getMonth()+1}æœˆ`;
      root.appendChild(monthTitle);
    }

    // entry
    const entry = document.createElement("div");
    entry.className = "entry";

    const date = document.createElement("div");
    date.className = "date";
    date.textContent = item.date;

    const p = document.createElement("p");
    p.innerHTML = item.lines.map(line => escapeHtml(line)).join("<br>");

    entry.appendChild(date);
    entry.appendChild(p);
    root.appendChild(entry);
  }
}

// "2026.02.25" / "2026-02-25" ã©ã£ã¡ã§ã‚‚èª­ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹
function parseDate(str){
  const s = str.trim().replaceAll(".", "-").replaceAll("/", "-");
  const [y, m, d] = s.split("-").map(n => parseInt(n, 10));
  return new Date(y, (m || 1) - 1, d || 1);
}

function escapeHtml(str){
  return str
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

loadDiary();
</script>

</body>

</html>